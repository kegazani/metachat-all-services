# üåê MetaChat - –ö–∞—Ä—Ç–∞ –ø–æ—Ä—Ç–æ–≤ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤
## –°–µ—Ä–≤–µ—Ä: **77.95.201.100**

---

## üì± –û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

| üéØ –°–µ—Ä–≤–∏—Å | üîå –ü–æ—Ä—Ç | üåç URL | üìù –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|---------|--------|-------------|
| **API Gateway** | `8080` | http://77.95.201.100:8080 | –ì–ª–∞–≤–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ |
| **User Service** (gRPC) | `50051` | 77.95.201.100:50051 | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ |
| **Diary Service** (gRPC) | `50052` | 77.95.201.100:50052 | –î–Ω–µ–≤–Ω–∏–∫–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ |
| **Matching Service** | `50053` | 77.95.201.100:50053 | –ü–æ–¥–±–æ—Ä —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ + HTTP:8081 |
| **Match Request Service** | `50054` | 77.95.201.100:50054 | –ó–∞–ø—Ä–æ—Å—ã –Ω–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è |
| **Chat Service** (gRPC) | `50055` | 77.95.201.100:50055 | –ß–∞—Ç—ã –∏ —Å–æ–æ–±—â–µ–Ω–∏—è |

---

## ü§ñ AI/ML –°–µ—Ä–≤–∏—Å—ã (Python)

| üéØ –°–µ—Ä–≤–∏—Å | üîå HTTP | üîå gRPC | üåç URL | üìù –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª |
|-----------|---------|---------|--------|---------------|
| **Mood Analysis** | `8000` | `50056` | http://77.95.201.100:8000 | –ê–Ω–∞–ª–∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è (AI) |
| **Analytics** | `8001` | `50057` | http://77.95.201.100:8001 | –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ —Å–æ–±—ã—Ç–∏–π |
| **Archetype** | `8002` | `50058` | http://77.95.201.100:8002 | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞—Ä—Ö–µ—Ç–∏–ø–∞ –ª–∏—á–Ω–æ—Å—Ç–∏ (Big Five) |
| **Biometric** | `8003` | - | http://77.95.201.100:8003 | –ë–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ |
| **Correlation** | `8004` | - | http://77.95.201.100:8004 | –ê–Ω–∞–ª–∏–∑ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π |

---

## üóÑÔ∏è –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

| üéØ –°–µ—Ä–≤–∏—Å | üîå –ü–æ—Ä—Ç(—ã) | üåç –î–æ—Å—Ç—É–ø | üìù –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|------------|-----------|---------------|
| **PostgreSQL** | `5432` | 77.95.201.100:5432 | –†–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –ë–î (chat, match-request) |
| | | User: `metachat` | Pass: `metachat_password` |
| **Cassandra** | `9042` | 77.95.201.100:9042 | NoSQL –ë–î (event sourcing, –¥–Ω–µ–≤–Ω–∏–∫–∏) |
| | `7000`, `7001` | Internal | Inter-node communication |
| **EventStore** | `2113` | http://77.95.201.100:2113 | Event Sourcing –ë–î |
| | `1113` | 77.95.201.100:1113 | TCP –ø–æ—Ä—Ç |

---

## üì® Message Broker (Kafka)

| üéØ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | üîå –ü–æ—Ä—Ç | üåç –î–æ—Å—Ç—É–ø | üìù –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-------------|---------|-----------|---------------|
| **Kafka** | `9092` | 77.95.201.100:9092 | External connection |
| | `29092` | Internal | Internal broker |
| **Zookeeper** | `2181` | 77.95.201.100:2181 | Kafka –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è |
| **Kafka UI** | `8090` | http://77.95.201.100:8090 | üñ•Ô∏è Web –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Kafka |

---

## üì° NATS (Message Streaming)

| üéØ –°–µ—Ä–≤–∏—Å | üîå –ü–æ—Ä—Ç | üìù –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|---------|---------------|
| **NATS** | `4222` | Client connections |
| | `8222` | HTTP monitoring |
| | `6222` | Cluster routing |

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏

| üéØ –°–µ—Ä–≤–∏—Å | üîå –ü–æ—Ä—Ç | üåç URL | üìù –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|---------|--------|-------------|
| **Grafana** | `3000` | http://77.95.201.100:3000 | üìà –î–∞—à–±–æ—Ä–¥—ã –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è |
| | | User: `admin` | Pass: `metachat2024` |
| **Prometheus** | `9090` | http://77.95.201.100:9090 | üìä –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ |
| **Loki** | `3100` | http://77.95.201.100:3100 | üìù –õ–æ–≥–∏ |

---

## üêù Docker Swarm (Production)

### –î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Swarm
```bash
cd docker
./deploy-swarm.sh
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```bash
docker stack ls
docker service ls
docker service scale metachat-services_api-gateway=4
docker service logs metachat-services_api-gateway -f
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ Swarm
- ‚úÖ **High Availability**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
- ‚úÖ **Load Balancing**: –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞
- ‚úÖ **Scaling**: –ü—Ä–æ—Å—Ç–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ **Rolling Updates**: –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑ –¥–∞—É–Ω—Ç–∞–π–º–∞

üìñ –ü–æ–¥—Ä–æ–±–Ω–µ–µ: `docker/SWARM_DEPLOYMENT.md`

---

## üî• –ë—ã—Å—Ç—Ä—ã–µ —Å—Å—ã–ª–∫–∏ –¥–ª—è –∞–¥–º–∏–Ω–∞

### üåê Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
```bash
API Gateway:       http://77.95.201.100:8080
Grafana:           http://77.95.201.100:3000
Prometheus:        http://77.95.201.100:9090
Kafka UI:          http://77.95.201.100:8090
EventStore UI:     http://77.95.201.100:2113
```

### üîå –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
```bash
# PostgreSQL
psql -h 77.95.201.100 -p 5432 -U metachat -d metachat

# Cassandra (CQL)
cqlsh 77.95.201.100 9042

# EventStore
curl http://77.95.201.100:2113/health/live
```

### üì® Kafka Topics
```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–æ–ø–∏–∫–∏
metachat-user-events                      # –°–æ–±—ã—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
metachat.diary.entry.created              # –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –¥–Ω–µ–≤–Ω–∏–∫–∞
metachat.diary.entry.updated              # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
metachat.mood.analyzed                    # –ê–Ω–∞–ª–∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è
metachat.personality.assigned             # –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏
metachat.biometric.data.received          # –ë–∏–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
metachat.correlation.discovered           # –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
```

---

## üîí –ü–æ—Ä—Ç—ã –¥–ª—è —Ñ–∞–π—Ä–≤–æ–ª–∞

### –û—Ç–∫—Ä—ã—Ç—å –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞:
```bash
8080    # API Gateway (–æ—Å–Ω–æ–≤–Ω–æ–π)
8000    # Mood Analysis API
8001    # Analytics API
8002    # Archetype API  
8003    # Biometric API
8004    # Correlation API
3000    # Grafana
```

### –û—Ç–∫—Ä—ã—Ç—å —Ç–æ–ª—å–∫–æ –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç–∏ / VPN:
```bash
5432    # PostgreSQL
9042    # Cassandra
2113    # EventStore HTTP
1113    # EventStore TCP
9092    # Kafka
2181    # Zookeeper
9090    # Prometheus
3100    # Loki
8090    # Kafka UI
```

### –ó–∞–∫—Ä—ã—Ç—å (—Ç–æ–ª—å–∫–æ internal docker network):
```bash
50051-50058  # gRPC —Å–µ—Ä–≤–∏—Å—ã (—á–µ—Ä–µ–∑ API Gateway)
29092        # Kafka internal
4222, 6222, 8222  # NATS
7000, 7001   # Cassandra inter-node
```

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ API Gateway
curl http://77.95.201.100:8080/health

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö HTTP —Å–µ—Ä–≤–∏—Å–æ–≤
for port in 8080 8000 8001 8002 8003 8004 3000 9090 8090 2113; do
  echo "Testing port $port..."
  curl -s -o /dev/null -w "%{http_code}" http://77.95.201.100:$port/health || echo " - not available"
done

# –ü—Ä–æ–≤–µ—Ä–∫–∞ PostgreSQL
pg_isready -h 77.95.201.100 -p 5432

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Cassandra
cqlsh 77.95.201.100 9042 -e "SELECT release_version FROM system.local;"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Kafka
kafkacat -b 77.95.201.100:9092 -L
```

---

## üì± –î–ª—è Flutter –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω–æ–π endpoint:
```dart
const String API_BASE_URL = "http://77.95.201.100:8080";
```

### WebSocket (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è):
```dart
const String WS_URL = "ws://77.95.201.100:8080/ws";
```

---

## üí° –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTPS (–ø–æ—Ä—Ç 443) —á–µ—Ä–µ–∑ Nginx/Traefik reverse proxy
2. **gRPC —Å–µ—Ä–≤–∏—Å—ã**: –î–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ API Gateway (–ø–æ—Ä—Ç 8080)
3. **Kafka**: –î–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ—Ä—Ç 9092
4. **EventStore**: Credentials –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: admin/changeit
5. **Grafana**: Credentials: admin/metachat2024

---

**–û–±–Ω–æ–≤–ª–µ–Ω–æ**: 12 –¥–µ–∫–∞–±—Ä—è 2025
**–°–µ—Ä–≤–µ—Ä**: 77.95.201.100
**–ü—Ä–æ–µ–∫—Ç**: MetaChat - Dating Platform with AI Personality Analysis

