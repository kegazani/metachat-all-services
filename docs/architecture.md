# MetaChat - ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ Ğ¸ Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²

## ğŸ—ï¸ ĞĞ±Ñ‰Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    ĞšĞ›Ğ˜Ğ•ĞĞ¢                                                â”‚
â”‚                              (Flutter Mobile App)                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚ HTTP REST
                                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              API GATEWAY (Go)                                            â”‚
â”‚                              Port: 8080                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ /auth/*        â”‚ /users/*       â”‚ /diary/*         â”‚ /matching/*               â”‚    â”‚
â”‚  â”‚ Register       â”‚ GetUser        â”‚ CreateEntry      â”‚ FindMatches               â”‚    â”‚
â”‚  â”‚ Login          â”‚ UpdateProfile  â”‚ GetEntry         â”‚ GetRecommendations        â”‚    â”‚
â”‚  â”‚ OAuth          â”‚ Personality    â”‚ UpdateEntry      â”‚ CalculateSimilarity       â”‚    â”‚
â”‚  â”‚                â”‚ Modalities     â”‚ DeleteEntry      â”‚                           â”‚    â”‚
â”‚  â”‚                â”‚                â”‚ Sessions         â”‚                           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚ gRPC            â”‚ gRPC            â”‚ gRPC            â”‚ gRPC
            â–¼                 â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   USER SERVICE   â”‚ â”‚  DIARY SERVICE   â”‚ â”‚ MATCHING SERVICE â”‚ â”‚MATCH REQUEST SVC â”‚
â”‚      (Go)        â”‚ â”‚      (Go)        â”‚ â”‚      (Go)        â”‚ â”‚      (Go)        â”‚
â”‚   Port: 50051    â”‚ â”‚   Port: 50052    â”‚ â”‚   Port: 50053    â”‚ â”‚   Port: 50054    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚                    â”‚                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CHAT SERVICE   â”‚ â”‚ARCHETYPE SERVICE â”‚ â”‚ ANALYTICS SERVICEâ”‚ â”‚ MOOD ANALYSIS    â”‚
â”‚      (Go)        â”‚ â”‚    (Python)      â”‚ â”‚    (Python)      â”‚ â”‚    (Python)      â”‚
â”‚   Port: 50055    â”‚ â”‚   Port: 50056    â”‚ â”‚   Port: 50057    â”‚ â”‚   Port: 8000     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚                    â”‚                    â”‚
         â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚    â”‚
         â–¼    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                    KAFKA                                                 â”‚
â”‚                              (Message Broker)                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ metachat-user-events      â”‚ metachat.diary.entry.created                        â”‚    â”‚
â”‚  â”‚ metachat.mood.analyzed    â”‚ metachat.diary.entry.updated                        â”‚    â”‚
â”‚  â”‚ metachat.personality.*    â”‚ metachat.diary.entry.deleted                        â”‚    â”‚
â”‚  â”‚ metachat.biometric.*      â”‚ metachat.correlation.discovered                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                 â”‚                 â”‚                 â”‚
             â–¼                 â–¼                 â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MOOD ANALYSIS   â”‚ â”‚ PERSONALITY SVC â”‚ â”‚ BIOMETRIC SERVICEâ”‚ â”‚CORRELATION SERVICEâ”‚
â”‚    (Python)      â”‚ â”‚    (Python)      â”‚ â”‚    (Python)      â”‚ â”‚    (Python)       â”‚
â”‚   Port: 8081     â”‚ â”‚   Port: 8082     â”‚ â”‚   Port: 8084     â”‚ â”‚   Port: 8085      â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•—  â”‚ â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•—  â”‚ â”‚                  â”‚ â”‚                   â”‚
â”‚  â•‘  AI/ML     â•‘  â”‚ â”‚  â•‘  AI/ML     â•‘  â”‚ â”‚                  â”‚ â”‚                   â”‚
â”‚  â•‘ Transformerâ•‘  â”‚ â”‚  â•‘ Big Five  â•‘  â”‚ â”‚                  â”‚ â”‚                   â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚ â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚ â”‚                  â”‚ â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
                              KAFKA TOPICS MAP
                                     
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USER SERVICE   â”‚â”€â”€â–º metachat-user-events â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   (consumers)   â”‚
â”‚     (Go)        â”‚                                      â”‚    optional     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                           
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    metachat.diary.entry.created     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DIARY SERVICE  â”‚â”€â”€â–º metachat.diary.entry.updated â”€â”€â”€â–ºâ”‚ MOOD ANALYSIS   â”‚
â”‚     (Go)        â”‚    metachat.diary.entry.deleted     â”‚   (Python)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚                               â”‚
                                 â–¼                               â–¼
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           metachat.mood.analyzed
                         â”‚  ANALYTICS    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                         â”‚   (Python)    â”‚                       â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                       â–¼
                                 â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               metachat.personality.updated            â”‚ PERSONALITY SVC â”‚
                                 â–²                      â”‚   (Python)      â”‚
                                 â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                                                â–¼
                                        metachat.personality.assigned
                                        metachat.personality.updated
                                        metachat.personality.calculation.triggered
                                                                           
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    metachat.biometric.data.received â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BIOMETRIC SVC   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ CORRELATION SVC â”‚
â”‚   (Python)      â”‚                                     â”‚   (Python)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                 â”‚
                        metachat.mood.analyzed â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                 â–¼
                                             metachat.correlation.discovered
```

## Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ ÑĞµÑ€Ğ²Ğ¸ÑĞ°Ğ¼

### 1. User Service (Producer)

**Ğ¢Ğ¾Ğ¿Ğ¸Ğº:** `metachat-user-events`

| Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Payload |

|---------|----------|---------|

| `UserRegistered` | ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ | user_id, username, email, first_name, last_name |

| `UserProfileUpdated` | ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»Ñ | user_id, updated_fields |

| `UserPersonalityAssigned` | Ğ›Ğ¸Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ° | user_id, openness, conscientiousness, extraversion, agreeableness, neuroticism, dominant_trait, confidence |

| `UserPersonalityUpdated` | Ğ›Ğ¸Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ° | user_id, openness, conscientiousness, extraversion, agreeableness, neuroticism, dominant_trait, confidence |

| `UserModalitiesUpdated` | ĞœĞ¾Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ñ‹ | user_id, modalities |

### 2. Diary Service (Producer)

**Ğ¢Ğ¾Ğ¿Ğ¸ĞºĞ¸:**

| Ğ¢Ğ¾Ğ¿Ğ¸Ğº | Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ | Payload |

|-------|---------|---------|

| `metachat.diary.entry.created` | Ğ—Ğ°Ğ¿Ğ¸ÑÑŒ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ° | diary_id, user_id, title, content, token_count, tags, created_at |

| `metachat.diary.entry.updated` | Ğ—Ğ°Ğ¿Ğ¸ÑÑŒ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ° | diary_id, user_id, title, content, token_count, tags, updated_at |

| `metachat.diary.entry.deleted` | Ğ—Ğ°Ğ¿Ğ¸ÑÑŒ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ° | diary_id, user_id, reason, deleted_at |

| `diary-events` | Ğ’ÑĞµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ Ğ´Ğ½ĞµĞ²Ğ½Ğ¸ĞºĞ° | event_type, payload |

| `session-events` | Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ ÑĞµÑÑĞ¸Ğ¹ | session_id, user_id, action |

### 3. Mood Analysis Service (Consumer/Producer)

**ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸:**

- `metachat.diary.entry.created`
- `metachat.diary.entry.updated`

**ĞŸÑƒĞ±Ğ»Ğ¸ĞºÑƒĞµÑ‚:**

| Ğ¢Ğ¾Ğ¿Ğ¸Ğº | Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ | Payload |

|-------|---------|---------|

| `metachat.mood.analyzed` | ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½ | user_id, diary_id, emotion_vector[8], dominant_emotion, valence, arousal, confidence, topics, keywords |

| `metachat.mood.analysis.failed` | ĞÑˆĞ¸Ğ±ĞºĞ° Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° | user_id, diary_id, error, timestamp |

### 4. Personality Service (Big Five) (Consumer/Producer)

**ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸:**

- `metachat.mood.analyzed`
- `metachat.diary.entry.created`

**ĞŸÑƒĞ±Ğ»Ğ¸ĞºÑƒĞµÑ‚:**

| Ğ¢Ğ¾Ğ¿Ğ¸Ğº | Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ | Payload |

|-------|---------|---------|

| `metachat.personality.assigned` | Ğ›Ğ¸Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ° | user_id, openness, conscientiousness, extraversion, agreeableness, neuroticism, dominant_trait, confidence, model_version, tokens_analyzed |

| `metachat.personality.updated` | Ğ›Ğ¸Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ° | user_id, openness, conscientiousness, extraversion, agreeableness, neuroticism, dominant_trait, confidence, model_version, tokens_analyzed |

| `metachat.personality.calculation.triggered` | Ğ—Ğ°Ğ¿ÑƒÑ‰ĞµĞ½ Ğ¿ĞµÑ€ĞµÑÑ‡ĞµÑ‚ | user_id, trigger_reason, tokens_count |

### 5. Analytics Service (Consumer only)

**ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸:**

- `metachat.mood.analyzed`
- `metachat.diary.entry.created`
- `metachat.diary.entry.deleted`
- `metachat.personality.updated`

### 6. Biometric Service (Producer)

**API Endpoints:**
- `POST /biometric/data` - ĞŸÑ€Ğ¸ĞµĞ¼ Ğ±Ğ¸Ğ¾Ğ¼ĞµÑ‚Ñ€Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¾Ñ‚ ÑƒÑÑ‚Ñ€Ğ¾Ğ¹ÑÑ‚Ğ²
- `POST /biometric/watch/data` - **NEW** ĞŸÑ€Ğ¸ĞµĞ¼ Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ñ ÑƒĞ¼Ğ½Ñ‹Ñ… Ñ‡Ğ°ÑĞ¾Ğ²
- `GET /biometric/data/{user_id}` - ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ±Ğ¸Ğ¾Ğ¼ĞµÑ‚Ñ€Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
- `GET /biometric/profile/{user_id}` - **NEW** Ğ‘Ğ¸Ğ¾Ğ¼ĞµÑ‚Ñ€Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
- `GET /biometric/summary/{user_id}` - **NEW** Ğ¡Ğ²Ğ¾Ğ´ĞºĞ° Ğ·Ğ° Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´
- `GET /biometric/summary/{user_id}/today` - **NEW** Ğ¡Ğ²Ğ¾Ğ´ĞºĞ° Ğ·Ğ° ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ
- `GET /biometric/emotional-state/{user_id}/current` - **NEW** Ğ¢ĞµĞºÑƒÑ‰ĞµĞµ ÑĞ¼Ğ¾Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ
- `GET /biometric/emotional-state/{user_id}/day/{date}` - **NEW** Ğ­Ğ¼Ğ¾Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ğ´Ğ½Ñ
- `GET /biometric/insights/{user_id}/day/{date}` - **NEW** Ğ˜Ğ½ÑĞ°Ğ¹Ñ‚Ñ‹ Ğ´Ğ½Ñ (Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ, Ğ»Ğ¾ĞºĞ°Ñ†Ğ¸Ğ¸, ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ)
- `GET /biometric/spikes/{user_id}` - **NEW** Ğ­Ğ¼Ğ¾Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ²ÑĞ¿Ğ»ĞµÑĞºĞ¸
- `WS /biometric/ws/{user_id}` - **NEW** WebSocket Ğ´Ğ»Ñ real-time Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ñ Ñ‡Ğ°ÑĞ¾Ğ²

**ĞŸÑƒĞ±Ğ»Ğ¸ĞºÑƒĞµÑ‚:**

| Ğ¢Ğ¾Ğ¿Ğ¸Ğº | Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ | Payload |

|-------|---------|---------|

| `metachat.biometric.data.received` | Ğ‘Ğ¸Ğ¾Ğ¼ĞµÑ‚Ñ€Ğ¸Ñ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ° | user_id, heart_rate, sleep_data, activity, device_id, timestamp |
| `metachat.watch.data.received` | **NEW** Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ Ñ‡Ğ°ÑĞ¾Ğ² | user_id, heart_rate, hrv, spo2, stress, steps, calories, device_type |
| `metachat.user.health.updated` | **NEW** Ğ—Ğ´Ğ¾Ñ€Ğ¾Ğ²ÑŒĞµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¾ | user_id, health_score, metrics summary |
| `metachat.emotional.state.analyzed` | **NEW** Ğ­Ğ¼Ğ¾Ñ†Ğ¸Ğ¸ Ğ¿Ñ€Ğ¾Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹ | user_id, date, overall_state, stability, insights |
| `metachat.day.insights.generated` | **NEW** Ğ˜Ğ½ÑĞ°Ğ¹Ñ‚Ñ‹ ÑĞ³ĞµĞ½ĞµÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹ | user_id, date, story, key_moments |

**Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ:**
- Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ±Ğ¸Ğ¾Ğ¼ĞµÑ‚Ñ€Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ² PostgreSQL
- ĞŸÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ Ğ² Kafka Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° heart_rate, hrv, blood_oxygen, stress_level, sleep, activity Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº
- **NEW** WebSocket Ğ´Ğ»Ñ real-time ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ñ ÑƒĞ¼Ğ½Ñ‹Ñ… Ñ‡Ğ°ÑĞ¾Ğ²
- **NEW** ĞĞ½Ğ°Ğ»Ğ¸Ğ· ÑĞ¼Ğ¾Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ Ğ±Ğ¸Ğ¾Ğ¼ĞµÑ‚Ñ€Ğ¸Ğ¸
- **NEW** ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ²ÑĞ¿Ğ»ĞµÑĞºĞ¾Ğ² ÑĞ¼Ğ¾Ñ†Ğ¸Ğ¹ Ğ¸ ĞºĞ»ÑÑ‡ĞµĞ²Ñ‹Ñ… Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚Ğ¾Ğ² Ğ´Ğ½Ñ
- **NEW** Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¸Ğ½ÑĞ°Ğ¹Ñ‚Ğ¾Ğ² Ğ¸ Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¹
- **NEW** ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ğ¾Ğ² Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¸ Ğ¼ĞµÑÑ‚Ğ¾Ğ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ

### 7. Correlation Service (Consumer/Producer)

**ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ¸:**

- `metachat.mood.analyzed`
- `metachat.biometric.data.received`

**ĞŸÑƒĞ±Ğ»Ğ¸ĞºÑƒĞµÑ‚:**

| Ğ¢Ğ¾Ğ¿Ğ¸Ğº | Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ | Payload |

|-------|---------|---------|

| `metachat.correlation.discovered` | ĞšĞ¾Ñ€Ñ€ĞµĞ»ÑÑ†Ğ¸Ñ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ° | user_id, correlation_type, mood_data, biometric_data, correlation_score, timestamp |

**Ğ¢Ğ¸Ğ¿Ñ‹ ĞºĞ¾Ñ€Ñ€ĞµĞ»ÑÑ†Ğ¸Ğ¹:**
- `heart_rate_valence` - ĞšĞ¾Ñ€Ñ€ĞµĞ»ÑÑ†Ğ¸Ñ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¿ÑƒĞ»ÑŒÑĞ¾Ğ¼ Ğ¸ Ğ²Ğ°Ğ»ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ñ
- `sleep_arousal` - ĞšĞ¾Ñ€Ñ€ĞµĞ»ÑÑ†Ğ¸Ñ Ğ¼ĞµĞ¶Ğ´Ñƒ ÑĞ½Ğ¾Ğ¼ Ğ¸ ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ¼ Ğ²Ğ¾Ğ·Ğ±ÑƒĞ¶Ğ´ĞµĞ½Ğ¸Ñ
- `activity_valence` - ĞšĞ¾Ñ€Ñ€ĞµĞ»ÑÑ†Ğ¸Ñ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ¸ Ğ²Ğ°Ğ»ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒÑ

**Ğ ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ:**
- ĞšÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ñ Ğ¸ Ğ±Ğ¸Ğ¾Ğ¼ĞµÑ‚Ñ€Ğ¸Ğ¸ Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
- Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· ĞºĞ¾Ñ€Ñ€ĞµĞ»ÑÑ†Ğ¸Ğ¹ (Pearson correlation)
- ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ: 14 Ğ´Ğ½ĞµĞ¹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…, 10+ Ğ·Ğ°Ğ¿Ğ¸ÑĞµĞ¹
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ Ğ·Ğ½Ğ°Ñ‡Ğ¸Ğ¼Ñ‹Ñ… ĞºĞ¾Ñ€Ñ€ĞµĞ»ÑÑ†Ğ¸Ğ¹ (p-value < 0.05, |r| > 0.3)

## ĞŸĞ¾Ñ‚Ğ¾ĞºĞ¸ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ (Event Flows)

### Flow 1: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸ Ğ² Ğ´Ğ½ĞµĞ²Ğ½Ğ¸ĞºĞµ

```
User â†’ API Gateway â†’ Diary Service
                          â”‚
                          â–¼ metachat.diary.entry.created
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼                 â–¼                 â–¼
   Mood Analysis    Personality Svc  Analytics Svc
        â”‚                                   â”‚
        â–¼ metachat.mood.analyzed            â”‚
        â”‚                                   â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”˜
        â–¼
   Personality Svc
        â”‚
        â–¼ metachat.personality.updated
        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºAnalytics Svc
```

### Flow 2: ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ±Ğ¸Ğ¾Ğ¼ĞµÑ‚Ñ€Ğ¸Ğ¸ Ğ¸ ĞºĞ¾Ñ€Ñ€ĞµĞ»ÑÑ†Ğ¸Ğ¹

```
Device â†’ Biometric Service
              â”‚
              â–¼ metachat.biometric.data.received
              â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºCorrelation Service
                                      â”‚
                                      â”‚ (ĞºÑÑˆĞ¸Ñ€ÑƒĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ)
                                      â”‚
                      (waits for)     â”‚
              metachat.mood.analyzedâ”€â”€â”˜
                                      â”‚
                                      â”‚ (Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ğ¿Ñ€Ğ¸ Ğ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾Ğ¼ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…)
                                      â”‚
                                      â–¼ metachat.correlation.discovered
                                      â”‚
                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºAnalytics Service (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)
```

### Flow 3: Real-time Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ ÑƒĞ¼Ğ½Ñ‹Ñ… Ñ‡Ğ°ÑĞ¾Ğ² Ğ¸ ÑĞ¼Ğ¾Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·

```
Smart Watch â†’ Flutter App â†’ WebSocket â†’ Biometric Service
                                              â”‚
                                              â”œâ”€â–º PostgreSQL (ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…)
                                              â”‚
                                              â”œâ”€â–º metachat.watch.data.received â”€â”€â”€â–º Correlation Service
                                              â”‚
                                              â”œâ”€â–º Emotional State Analyzer
                                              â”‚         â”‚
                                              â”‚         â”œâ”€â–º ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ³Ğ¾ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ
                                              â”‚         â”‚     (calm, stressed, energized, etc.)
                                              â”‚         â”‚
                                              â”‚         â”œâ”€â–º ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ ÑĞ¼Ğ¾Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… Ğ²ÑĞ¿Ğ»ĞµÑĞºĞ¾Ğ²
                                              â”‚         â”‚     (Ñ€ĞµĞ·ĞºĞ¸Ğµ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ HR, ÑÑ‚Ñ€ĞµÑÑĞ°)
                                              â”‚         â”‚
                                              â”‚         â””â”€â–º ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ğ¾Ğ² Ğ´Ğ½Ñ
                                              â”‚               â”‚
                                              â”‚               â–¼
                                              â”‚         metachat.emotional.state.analyzed
                                              â”‚
                                              â””â”€â–º Day Insights Analyzer
                                                        â”‚
                                                        â”œâ”€â–º ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ Ğ¼ĞµÑÑ‚Ğ¾Ğ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
                                                        â”‚     (Ğ´Ğ¾Ğ¼, Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°, Ñ‚Ñ€Ğ°Ğ½ÑĞ¿Ğ¾Ñ€Ñ‚)
                                                        â”‚
                                                        â”œâ”€â–º ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸
                                                        â”‚     (Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°, Ñ‚Ñ€ĞµĞ½Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°, Ğ¾Ñ‚Ğ´Ñ‹Ñ…)
                                                        â”‚
                                                        â”œâ”€â–º ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚Ñ‹ Ğ´Ğ½Ñ
                                                        â”‚
                                                        â””â”€â–º Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ "Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ğ¸ Ğ´Ğ½Ñ"
                                                              â”‚
                                                              â–¼
                                                        metachat.day.insights.generated

```

**Ğ¢Ğ¸Ğ¿Ñ‹ ÑĞ¼Ğ¾Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¹:**
- `calm` - Ğ¡Ğ¿Ğ¾ĞºĞ¾Ğ¹ÑÑ‚Ğ²Ğ¸Ğµ (Ğ½Ğ¸Ğ·ĞºĞ¸Ğ¹ HR, Ğ²Ñ‹ÑĞ¾ĞºĞ¸Ğ¹ HRV, Ğ½Ğ¸Ğ·ĞºĞ¸Ğ¹ ÑÑ‚Ñ€ĞµÑÑ)
- `relaxed` - Ğ Ğ°ÑÑĞ»Ğ°Ğ±Ğ»ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ
- `energized` - Ğ­Ğ½ĞµÑ€Ğ³Ğ¸Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ (Ğ¿Ğ¾Ğ²Ñ‹ÑˆĞµĞ½Ğ½Ğ°Ñ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ)
- `focused` - Ğ¡Ğ¾ÑÑ€ĞµĞ´Ğ¾Ñ‚Ğ¾Ñ‡ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ
- `stressed` - ĞĞ°Ğ¿Ñ€ÑĞ¶ĞµĞ½Ğ¸Ğµ (Ğ²Ñ‹ÑĞ¾ĞºĞ¸Ğ¹ HR, Ğ½Ğ¸Ğ·ĞºĞ¸Ğ¹ HRV, Ğ²Ñ‹ÑĞ¾ĞºĞ¸Ğ¹ ÑÑ‚Ñ€ĞµÑÑ)
- `anxious` - Ğ¢Ñ€ĞµĞ²Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ
- `tired` - Ğ£ÑÑ‚Ğ°Ğ»Ğ¾ÑÑ‚ÑŒ (Ğ½Ğ¸Ğ·ĞºĞ°Ñ ÑĞ½ĞµÑ€Ğ³Ğ¸Ñ, Ğ¿Ğ»Ğ¾Ñ…Ğ¾Ğ¹ ÑĞ¾Ğ½)
- `excited` - Ğ’Ğ¾Ğ·Ğ±ÑƒĞ¶Ğ´ĞµĞ½Ğ¸Ğµ

**ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ²ÑĞ¿Ğ»ĞµÑĞºĞ¾Ğ²:**
- ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ Ñ€ĞµĞ·ĞºĞ¸Ñ… Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹ HR (>20% Ğ·Ğ° 15 Ğ¼Ğ¸Ğ½)
- ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ ÑĞºĞ°Ñ‡ĞºĞ¾Ğ² ÑÑ‚Ñ€ĞµÑÑĞ°
- ĞšĞ¾Ğ½Ñ‚ĞµĞºÑÑ‚ Ğ²ÑĞ¿Ğ»ĞµÑĞºĞ° (Ğ¼ĞµÑÑ‚Ğ¾Ğ¿Ğ¾Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ, Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ)

---

## ğŸ“¡ API Endpoints (Ğ ÑƒÑ‡ĞºĞ¸)

### ğŸ” Auth Routes (`/auth/*`) â†’ User Service

| Method | Endpoint | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|--------|----------|----------|
| POST | `/auth/register` | Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ |
| POST | `/auth/login` | ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ |
| POST | `/auth/oauth/{provider}` | OAuth Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ (Google/Apple) |

### ğŸ‘¤ User Routes (`/users/*`) â†’ User Service

| Method | Endpoint | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|--------|----------|----------|
| GET | `/users/{id}` | ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ |
| PUT | `/users/{id}` | ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ |
| GET | `/users` | Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹ |
| POST | `/users/{id}/personality` | ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸Ñ‚ÑŒ Ğ»Ğ¸Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ (Big Five) |
| PUT | `/users/{id}/personality` | ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ»Ğ¸Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ (Big Five) |
| PUT | `/users/{id}/modalities` | ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ¼Ğ¾Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ |
| GET | `/users/{id}/profile-progress` | **NEW** ĞŸÑ€Ğ¾Ğ³Ñ€ĞµÑÑ Ñ€Ğ°ÑÑ‡ĞµÑ‚Ğ° Ğ»Ğ¸Ñ‡Ğ½Ğ¾ÑÑ‚Ğ¸ |
| GET | `/users/{id}/statistics` | **NEW** Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ |

### ğŸ’‘ Matching Routes (`/matching/*`) â†’ Matching Service

| Method | Endpoint | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|--------|----------|----------|
| GET | `/users/{id1}/common-topics/{id2}` | **NEW** ĞĞ±Ñ‰Ğ¸Ğµ Ñ‚ĞµĞ¼Ñ‹ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑĞ¼Ğ¸ |

### ğŸ’Œ Match Request Routes (`/match-requests/*`) â†’ Match Request Service

| Method | Endpoint | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|--------|----------|----------|
| POST | `/match-requests` | **NEW** Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ½Ğ° Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ |
| GET | `/match-requests/user/{user_id}` | **NEW** ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ |
| PUT | `/match-requests/{request_id}/accept` | **NEW** ĞŸÑ€Ğ¸Ğ½ÑÑ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ |
| PUT | `/match-requests/{request_id}/reject` | **NEW** ĞÑ‚ĞºĞ»Ğ¾Ğ½Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ |
| GET | `/match-requests/{request_id}` | **NEW** ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ¿Ğ¾ ID |
| DELETE | `/match-requests/{request_id}` | **NEW** ĞÑ‚Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ |

### ğŸ’¬ Chat Routes (`/chats/*`) â†’ Chat Service

| Method | Endpoint | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|--------|----------|----------|
| POST | `/chats` | **NEW** Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ñ‡Ğ°Ñ‚ |
| GET | `/chats/{chat_id}` | **NEW** ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ñ‡Ğ°Ñ‚ |
| GET | `/chats/user/{user_id}` | **NEW** Ğ§Ğ°Ñ‚Ñ‹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ |
| POST | `/chats/{chat_id}/messages` | **NEW** ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ |
| GET | `/chats/{chat_id}/messages` | **NEW** Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹ |
| PUT | `/chats/{chat_id}/messages/read` | **NEW** ĞÑ‚Ğ¼ĞµÑ‚Ğ¸Ñ‚ÑŒ ĞºĞ°Ğº Ğ¿Ñ€Ğ¾Ñ‡Ğ¸Ñ‚Ğ°Ğ½Ğ½Ñ‹Ğµ |

### ğŸ“” Diary Routes (`/diary/*`) â†’ Diary Service

| Method | Endpoint | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|--------|----------|----------|
| POST | `/diary/entries` | Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ Ğ² Ğ´Ğ½ĞµĞ²Ğ½Ğ¸ĞºĞµ |
| GET | `/diary/entries/{id}` | ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ |
| PUT | `/diary/entries/{id}` | ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ |
| DELETE | `/diary/entries/{id}` | Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ |
| GET | `/diary/entries` | Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ·Ğ°Ğ¿Ğ¸ÑĞµĞ¹ |
| GET | `/diary/entries/user/{userId}` | Ğ—Ğ°Ğ¿Ğ¸ÑĞ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ |
| POST | `/diary/sessions` | ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ ÑĞµÑÑĞ¸Ñ |
| GET | `/diary/sessions/{id}` | ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ÑĞµÑÑĞ¸Ñ |
| PUT | `/diary/sessions/{id}/end` | Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚ÑŒ ÑĞµÑÑĞ¸Ñ |
| GET | `/diary/sessions` | Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº ÑĞµÑÑĞ¸Ğ¹ |
| GET | `/diary/sessions/user/{userId}` | Ğ¡ĞµÑÑĞ¸Ğ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ |
| GET | `/diary/analytics` | ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸ĞºĞ° Ğ´Ğ½ĞµĞ²Ğ½Ğ¸ĞºĞ° |

---

## ğŸ“¨ Kafka Events (Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ)

### ĞŸĞ¾Ñ‚Ğ¾Ğº ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ Ğ¿Ñ€Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğ¸ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸ Ğ² Ğ´Ğ½ĞµĞ²Ğ½Ğ¸ĞºĞµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client POST    â”‚â”€â”€â”€â–¶â”‚  Diary Service  â”‚â”€â”€â”€â–¶â”‚     Kafka       â”‚â”€â”€â”€â–¶â”‚  Mood Analysis  â”‚
â”‚  /diary/entries â”‚    â”‚  Save Entry     â”‚    â”‚ diary.entry.    â”‚    â”‚  Service        â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚ created         â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                              â”‚
                                                                     AI Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ñ‚ĞµĞºÑÑ‚Ğ°
                                                                     Plutchik Model
                                                                              â”‚
                                                                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User Profile  â”‚â—€â”€â”€â”€â”‚ Personality     â”‚â—€â”€â”€â”€â”‚     Kafka       â”‚â—€â”€â”€â”€â”‚  Kafka Producer â”‚
â”‚   Updated       â”‚    â”‚ Service         â”‚    â”‚ mood.analyzed   â”‚    â”‚  mood.analyzed  â”‚
â”‚                 â”‚    â”‚ Big Five AI     â”‚    â”‚                 â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Ğ¢Ğ¾Ğ¿Ğ¸ĞºĞ¸ Kafka

```yaml
# User Service â†’ Producer
metachat-user-events:
  - UserCreated
  - UserProfileUpdated
  - PersonalityAssigned
  - PersonalityUpdated
  - ModalitiesUpdated

# Diary Service â†’ Producer
metachat.diary.entry.created:
  - entry_id, user_id, content, token_count, tags
  
metachat.diary.entry.updated:
  - entry_id, user_id, content, token_count, tags
  
metachat.diary.entry.deleted:
  - entry_id, user_id, reason

# Mood Analysis Service
CONSUMES:
  - metachat.diary.entry.created
  - metachat.diary.entry.updated
PRODUCES:
  - metachat.mood.analyzed
  - metachat.mood.analysis.failed

# Personality Service (Big Five)
CONSUMES:
  - metachat.mood.analyzed
  - metachat.diary.entry.created
PRODUCES:
  - metachat.personality.assigned
  - metachat.personality.updated
  - metachat.personality.calculation.triggered

# Analytics Service
CONSUMES:
  - metachat.mood.analyzed
  - metachat.diary.entry.created
  - metachat.diary.entry.deleted
  - metachat.personality.updated

# Biometric Service â†’ Producer
metachat.biometric.data.received:
  - user_id, heart_rate, sleep_data, activity

# Correlation Service
CONSUMES:
  - metachat.mood.analyzed
  - metachat.biometric.data.received
PRODUCES:
  - metachat.correlation.discovered
```

---

## ğŸ¤– AI/ML ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

### 1. Mood Analysis Service (ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ñ)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        MOOD ANALYSIS PIPELINE                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚   Text Input   â”‚â”€â”€â”€â”€â–¶â”‚   Preprocessing  â”‚â”€â”€â”€â”€â–¶â”‚   Transformer     â”‚    â”‚
â”‚   â”‚   (Diary)      â”‚     â”‚   - Clean text   â”‚     â”‚   Model           â”‚    â”‚
â”‚   â”‚                â”‚     â”‚   - Remove URLs  â”‚     â”‚   (HuggingFace)   â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   - Tokenize     â”‚     â”‚                   â”‚    â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚   â–¼                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ Sentiment Score  â”‚â”€â”€â”€â”€â–¶â”‚  Plutchik Model   â”‚â”€â”€â”€â”€â–¶â”‚ Emotion Vector  â”‚   â”‚
â”‚   â”‚ positive/neutral â”‚     â”‚  8 Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ñ… ÑĞ¼Ğ¾Ñ†Ğ¸Ğ¹ â”‚     â”‚ [8 float values]â”‚   â”‚
â”‚   â”‚ /negative        â”‚     â”‚                   â”‚     â”‚                 â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                               â”‚             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚   â–¼                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚   â”‚ Topic Analyzer   â”‚     â”‚ Output:           â”‚                           â”‚
â”‚   â”‚ - Keywords       â”‚â”€â”€â”€â”€â–¶â”‚ - emotion_vector  â”‚                           â”‚
â”‚   â”‚ - Topics         â”‚     â”‚ - valence/arousal â”‚                           â”‚
â”‚   â”‚                  â”‚     â”‚ - topics/keywords â”‚                           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ - confidence      â”‚                           â”‚
â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Plutchik Model - 8 Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ñ… ÑĞ¼Ğ¾Ñ†Ğ¸Ğ¹:

```python
EMOTIONS = [
    "joy",          # Ğ Ğ°Ğ´Ğ¾ÑÑ‚ÑŒ      (+valence, +arousal)
    "trust",        # Ğ”Ğ¾Ğ²ĞµÑ€Ğ¸Ğµ      (+valence, low arousal)
    "fear",         # Ğ¡Ñ‚Ñ€Ğ°Ñ…        (-valence, high arousal)
    "surprise",     # Ğ£Ğ´Ğ¸Ğ²Ğ»ĞµĞ½Ğ¸Ğµ    (neutral, high arousal)
    "sadness",      # Ğ“Ñ€ÑƒÑÑ‚ÑŒ       (-valence, low arousal)
    "disgust",      # ĞÑ‚Ğ²Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ğµ   (-valence, -arousal)
    "anger",        # Ğ“Ğ½ĞµĞ²         (-valence, high arousal)
    "anticipation"  # ĞŸÑ€ĞµĞ´Ğ²ĞºÑƒÑˆĞµĞ½Ğ¸Ğµ (+valence, +arousal)
]
```

### 2. Personality Service (Big Five / OCEAN)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BIG FIVE PERSONALITY CLASSIFICATION                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚   â”‚ User History   â”‚     â”‚ Aggregated Data  â”‚                               â”‚
â”‚   â”‚ - Entries      â”‚â”€â”€â”€â”€â–¶â”‚ - Emotion avg    â”‚                               â”‚
â”‚   â”‚ - Moods        â”‚     â”‚ - Topic distrib  â”‚                               â”‚
â”‚   â”‚ - Tokens       â”‚     â”‚ - Style metrics  â”‚                               â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                   â”‚                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚   â–¼                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                    BIG FIVE CLASSIFIER                                 â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚   â”‚  â”‚ Factor Calculation:                                              â”‚ â”‚  â”‚
â”‚   â”‚  â”‚   - Openness: surprise, anticipation, creative topics            â”‚ â”‚  â”‚
â”‚   â”‚  â”‚   - Conscientiousness: trust, work topics, entry length          â”‚ â”‚  â”‚
â”‚   â”‚  â”‚   - Extraversion: joy, surprise, social topics, arousal          â”‚ â”‚  â”‚
â”‚   â”‚  â”‚   - Agreeableness: trust, joy, social topics, -negative         â”‚ â”‚  â”‚
â”‚   â”‚  â”‚   - Neuroticism: fear, sadness, anger, stress topics             â”‚ â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                   â”‚                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚   â–¼                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                    BIG FIVE (OCEAN) - 5 Ğ¤ĞĞšĞ¢ĞĞ ĞĞ’                      â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚  â”‚
â”‚   â”‚  â”‚  Openness    â”‚ â”‚Conscientious â”‚ â”‚ Extraversion â”‚                â”‚  â”‚
â”‚   â”‚  â”‚  (O) 0.0-1.0 â”‚ â”‚  (C) 0.0-1.0 â”‚ â”‚  (E) 0.0-1.0 â”‚                â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚  â”‚
â”‚   â”‚  â”‚ Agreeablenessâ”‚ â”‚ Neuroticism â”‚                                   â”‚  â”‚
â”‚   â”‚  â”‚  (A) 0.0-1.0 â”‚ â”‚  (N) 0.0-1.0 â”‚                                   â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Big Five Ñ„Ğ°ĞºÑ‚Ğ¾Ñ€Ñ‹:

| Ğ¤Ğ°ĞºÑ‚Ğ¾Ñ€ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ˜Ğ½Ğ´Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€Ñ‹ |
|--------|----------|------------|
| **Openness (O)** | ĞÑ‚ĞºÑ€Ñ‹Ñ‚Ğ¾ÑÑ‚ÑŒ Ğ¾Ğ¿Ñ‹Ñ‚Ñƒ | surprise, anticipation, Ñ‚Ğ²Ğ¾Ñ€Ñ‡ĞµÑĞºĞ¸Ğµ Ñ‚ĞµĞ¼Ñ‹, ÑĞ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚ÑŒ Ñ‚ĞµĞºÑÑ‚Ğ° |
| **Conscientiousness (C)** | Ğ”Ğ¾Ğ±Ñ€Ğ¾ÑĞ¾Ğ²ĞµÑÑ‚Ğ½Ğ¾ÑÑ‚ÑŒ | trust, Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°/ÑƒÑ‡ĞµĞ±Ğ°, Ğ´Ğ»Ğ¸Ğ½Ğ° Ğ·Ğ°Ğ¿Ğ¸ÑĞµĞ¹, Ğ¿Ğ¾Ğ»Ğ¾Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ²Ğ°Ğ»ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ |
| **Extraversion (E)** | Ğ­ĞºÑÑ‚Ñ€Ğ°Ğ²ĞµÑ€ÑĞ¸Ñ | joy, surprise, ÑĞ¾Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ‚ĞµĞ¼Ñ‹, Ğ²Ñ‹ÑĞ¾ĞºĞ¸Ğ¹ arousal |
| **Agreeableness (A)** | Ğ”Ğ¾Ğ±Ñ€Ğ¾Ğ¶ĞµĞ»Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ | trust, joy, ÑĞ¾Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ‚ĞµĞ¼Ñ‹, Ğ½Ğ¸Ğ·ĞºĞ¸Ğµ Ğ¾Ñ‚Ñ€Ğ¸Ñ†Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ ÑĞ¼Ğ¾Ñ†Ğ¸Ğ¸ |
| **Neuroticism (N)** | ĞĞµĞ¹Ñ€Ğ¾Ñ‚Ğ¸Ğ·Ğ¼ | fear, sadness, anger, ÑÑ‚Ñ€ĞµÑÑ-Ñ‚ĞµĞ¼Ñ‹, Ğ¾Ñ‚Ñ€Ğ¸Ñ†Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ²Ğ°Ğ»ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ |

---

## ğŸ”„ Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹ Ğ¿ĞµÑ€ĞµÑÑ‡ĞµÑ‚Ğ° Ğ»Ğ¸Ñ‡Ğ½Ğ¾ÑÑ‚Ğ¸ (Big Five)

```python
TRIGGERS = {
    "initial_threshold": 50,         # Ñ‚Ğ¾ĞºĞµĞ½Ğ¾Ğ² Ğ´Ğ»Ñ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ñ€Ğ°ÑÑ‡ĞµÑ‚Ğ°
    "recalculation_tokens": 100,    # Ñ‚Ğ¾ĞºĞµĞ½Ğ¾Ğ² Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¿ĞµÑ€ĞµÑÑ‡ĞµÑ‚Ğ°Ğ¼Ğ¸
    "recalculation_days": 7,        # Ğ´Ğ½ĞµĞ¹ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¿ĞµÑ€ĞµÑÑ‡ĞµÑ‚Ğ°Ğ¼Ğ¸
    "min_confidence": 0.3           # Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ°Ñ ÑƒĞ²ĞµÑ€ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ
}
```

---

## ğŸ“Š Matching Service (ĞŸĞ¾Ğ´Ğ±Ğ¾Ñ€ Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER MATCHING                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚  User A        â”‚     â”‚  User Portraits  â”‚     â”‚  Similarity       â”‚    â”‚
â”‚   â”‚  - big_five    â”‚â”€â”€â”€â”€â–¶â”‚  Comparison      â”‚â”€â”€â”€â”€â–¶â”‚  Calculation      â”‚    â”‚
â”‚   â”‚  - emotions    â”‚     â”‚                  â”‚     â”‚                   â”‚    â”‚
â”‚   â”‚  - topics      â”‚     â”‚                  â”‚     â”‚ cosine_similarity â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚ + big_five_match  â”‚    â”‚
â”‚                          â”‚  â”‚  User B    â”‚  â”‚     â”‚ + topic_overlap   â”‚    â”‚
â”‚                          â”‚  â”‚  portrait  â”‚  â”‚     â”‚                   â”‚    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚   â”‚  All Users     â”‚â”€â”€â”€â”€â–¶â”‚                  â”‚               â”‚              â”‚
â”‚   â”‚  (candidates)  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚              â”‚
â”‚                                                             â–¼              â”‚
â”‚                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚                                              â”‚ Sorted Matches            â”‚ â”‚
â”‚                                              â”‚ [user_id, similarity]     â”‚ â”‚
â”‚                                              â”‚ Top N recommendations     â”‚ â”‚
â”‚                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ï¸ Ğ‘Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### Event Store (PostgreSQL + Event Sourcing)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          EVENT STORE                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  events                                                                      â”‚
â”‚  â”œâ”€â”€ id (UUID)                                                              â”‚
â”‚  â”œâ”€â”€ aggregate_id (UUID)                                                    â”‚
â”‚  â”œâ”€â”€ aggregate_type (user/diary)                                            â”‚
â”‚  â”œâ”€â”€ event_type                                                             â”‚
â”‚  â”œâ”€â”€ version                                                                â”‚
â”‚  â”œâ”€â”€ payload (JSONB)                                                        â”‚
â”‚  â”œâ”€â”€ metadata (JSONB) - correlation_id, causation_id                        â”‚
â”‚  â””â”€â”€ created_at                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Read Models (Cassandra)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          READ MODELS                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  users_by_id           â”‚  diary_entries_by_id    â”‚  mood_analyses           â”‚
â”‚  â”œâ”€â”€ id               â”‚  â”œâ”€â”€ id                 â”‚  â”œâ”€â”€ entry_id             â”‚
â”‚  â”œâ”€â”€ username         â”‚  â”œâ”€â”€ user_id            â”‚  â”œâ”€â”€ user_id              â”‚
â”‚  â”œâ”€â”€ email            â”‚  â”œâ”€â”€ title              â”‚  â”œâ”€â”€ emotion_vector       â”‚
â”‚  â”œâ”€â”€ big_five          â”‚  â”œâ”€â”€ content            â”‚  â”œâ”€â”€ dominant_emotion     â”‚
â”‚  â”œâ”€â”€ modalities       â”‚  â”œâ”€â”€ token_count        â”‚  â”œâ”€â”€ valence              â”‚
â”‚  â””â”€â”€ updated_at       â”‚  â””â”€â”€ created_at         â”‚  â””â”€â”€ arousal              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ñ†Ğ¸ĞºĞ» Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

```
                                    USER ACTION
                                         â”‚
                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ¿Ğ¸ÑˆĞµÑ‚ Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ Ğ² Ğ´Ğ½ĞµĞ²Ğ½Ğ¸Ğº                                     â”‚
â”‚     POST /diary/entries { content: "Ğ¡ĞµĞ³Ğ¾Ğ´Ğ½Ñ Ğ±Ñ‹Ğ» Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ Ğ´ĞµĞ½ÑŒ..." }         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Diary Service ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ Ğ¸ Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºÑƒĞµÑ‚ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ                      â”‚
â”‚     â†’ Kafka: metachat.diary.entry.created                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. Mood Analysis Service Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ Ğ¸ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµÑ‚ Ñ‚ĞµĞºÑÑ‚              â”‚
â”‚     - Transformer model Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ sentiment                                â”‚
â”‚     - Plutchik model ÑĞ¾Ğ·Ğ´Ğ°ĞµÑ‚ emotion vector                                 â”‚
â”‚     - Topic analyzer Ğ¸Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµÑ‚ Ñ‚ĞµĞ¼Ñ‹ Ğ¸ ĞºĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ ÑĞ»Ğ¾Ğ²Ğ°                        â”‚
â”‚     â†’ Kafka: metachat.mood.analyzed                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. Personality Service Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ñ                         â”‚
â”‚     - ĞĞ³Ñ€ĞµĞ³Ğ¸Ñ€ÑƒĞµÑ‚ ÑĞ¼Ğ¾Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ (70% ÑÑ‚Ğ°Ñ€Ñ‹Ğµ + 30% Ğ½Ğ¾Ğ²Ñ‹Ğµ)              â”‚
â”‚     - ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ñ‚ĞµĞ¼                                           â”‚
â”‚     - ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ñ‹ (Ñ‚Ğ¾ĞºĞµĞ½Ñ‹/Ğ²Ñ€ĞµĞ¼Ñ)                                     â”‚
â”‚     - ĞŸÑ€Ğ¸ Ğ´Ğ¾ÑÑ‚Ğ¸Ğ¶ĞµĞ½Ğ¸Ğ¸ Ğ¿Ğ¾Ñ€Ğ¾Ğ³Ğ° â†’ Ğ¿ĞµÑ€ĞµÑÑ‡ĞµÑ‚ Big Five                             â”‚
â”‚     â†’ Kafka: metachat.personality.assigned/updated                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. Analytics Service ÑĞ¾Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ                                   â”‚
â”‚     - ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ                                        â”‚
â”‚     - ĞĞ³Ñ€ĞµĞ³Ğ¸Ñ€ÑƒĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ»Ñ Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ğ¾Ğ²                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6. Matching Service Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ñ„Ğ¸Ğ»ÑŒ                         â”‚
â”‚     - User Portrait Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½ Ñ Ğ½Ğ¾Ğ²Ñ‹Ğ¼Ğ¸ Big Five Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»ÑĞ¼Ğ¸                 â”‚
â”‚     - Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ñ… Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹ Ğ¿ĞµÑ€ĞµÑÑ‡Ğ¸Ñ‚Ñ‹Ğ²Ğ°ÑÑ‚ÑÑ                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ› ï¸ Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ ÑÑ‚ĞµĞº

| ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ | Ğ¢ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ñ |
|-----------|------------|
| API Gateway | Go + gorilla/mux |
| User Service | Go + gRPC + Event Sourcing |
| Diary Service | Go + gRPC + Event Sourcing |
| Matching Service | Go |
| Mood Analysis | Python + FastAPI + Transformers |
| Personality Service | Python + FastAPI + NumPy |
| Analytics Service | Python + FastAPI |
| Biometric Service | Python + FastAPI |
| Correlation Service | Python + FastAPI + NumPy + SciPy |
| Message Broker | Apache Kafka |
| Event Store | PostgreSQL |
| Read Store | Apache Cassandra |
| Cache | Redis |
| Client | Flutter/Dart |

---

## ğŸ“¦ Docker Ğ¿Ğ¾Ñ€Ñ‚Ñ‹

| Service | Port | Type |
|---------|------|------|
| API Gateway | 8080 | HTTP |
| User Service | 50051 | gRPC |
| Diary Service | 50052 | gRPC |
| Matching Service | 50053 | gRPC |
| **Match Request Service** | **50054** | **gRPC** |
| **Chat Service** | **50055** | **gRPC** |
| **Archetype Service** | **50056** | **gRPC** |
| **Analytics Service** | **50057** | **gRPC** |
| Mood Analysis Service | 8000 | HTTP |
| Archetype Service (HTTP) | 8001 | HTTP |
| Analytics Service (HTTP) | 8002 | HTTP |
| Biometric Service | 8084 | HTTP |
| Correlation Service | 8085 | HTTP |
| Kafka | 9092 | TCP |
| Kafka UI | 8090 | HTTP |
| PostgreSQL | 5432 | TCP |
| Cassandra | 9042 | TCP |
| Redis | 6379 | TCP |

